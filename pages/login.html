<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ECOLUD – Connexion partenaire</title>
    <link rel="stylesheet" href="../assets/css/style.css" />
    <link rel="stylesheet" href="../assets/css/game.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      .page-login main {
        padding-top: 88px;
        min-height: calc(100vh - 88px);
        display: grid;
        align-items: start;
        gap: 3rem;
      }
      .page-login .login-hero {
        padding: 4rem 6vw 0;
        text-align: center;
        display: grid;
        gap: 1.4rem;
      }
      .page-login .login-hero p {
        margin: 0 auto;
        max-width: 540px;
        color: var(--text-muted);
        line-height: 1.7;
      }
      .page-login .login-grid {
        padding: 0 6vw 4rem;
        display: grid;
        justify-items: center;
      }
      .page-login .login-card {
        width: min(520px, 100%);
        background: var(--card-bg);
        border-radius: var(--radius-md);
        box-shadow: var(--shadow-soft);
        padding: clamp(2rem, 4vw, 2.8rem);
      }
      .page-login .login-card h2 {
        margin-top: 0;
        margin-bottom: 1.2rem;
        color: var(--primary-dark);
        text-align: center;
      }
      .page-login .login-form .form-group {
        display: grid;
        gap: 0.45rem;
        margin-bottom: 1.1rem;
      }
      .page-login .form-error {
        margin: 0.8rem 0 0;
        font-weight: 600;
        color: #c53b47;
      }
      .page-login .form-error.hidden {
        display: none;
      }
      .page-login .login-footer {
        margin-top: 1.4rem;
        text-align: center;
        color: var(--text-muted);
      }
    </style>
  </head>
  <body class="page-login">
    <header class="site-header" id="siteHeader">
      <a href="../index.html" class="site-logo" aria-label="ECOLUD accueil">
        <img src="../assets/images/logo/ecolud.png" alt="ECOLUD" />
      </a>
      <nav class="site-nav" aria-label="Navigation principale">
        <a href="../index.html#top" data-i18n="nav-home">Accueil</a>
        <a href="../index.html#shop" data-i18n="nav-shop">Boutique</a>
        <a href="game.html" data-i18n="nav-play">Jouer</a>
        <!-- <a href="../index.html#experience" data-i18n="nav-experience">Expérience</a> -->
        <a href="login.html" class="active" data-i18n="nav-partner" id="navPartnerLink">Partenaire</a>
        <a href="contact.html" data-i18n="nav-contact">Contact</a>
      </nav>
      <div class="header-actions">
        <div class="nav-session" id="navSession">
          <div class="player-badge user-info hidden" id="navPlayerBadge" aria-live="polite">
            <img id="navPlayerAvatar" src="" alt="Avatar du joueur" />
            <span id="navPlayerName"></span>
          </div>
          <button
            type="button"
            class="btn btn-ghost nav-change hidden"
            id="navChangeProfile"
            data-change-profile
            data-profile-target="pages/choose.html"
            data-profile-mode="reset"
            data-i18n="change-profile"
          >
            Changer de profil
          </button>
        </div>
        <div class="partner-actions hidden" id="partnerActions">
          <a href="prototypes.html" class="btn btn-ghost" id="partnerSpaceLink" data-i18n="partner-space">
            Mon espace
          </a>
          <button type="button" class="btn btn-ghost" id="partnerLogoutBtn" data-i18n="partner-logout">
            Déconnexion
          </button>
        </div>
      </div>
    </header>

    <main data-i18n-container>
      <section class="login-hero">
        <h1>Connexion partenaire ECOLUD</h1>
        <p>
          Accédez à votre espace de test, retrouvez vos prototypes assignés et partagez vos retours avec
          l’équipe ECOLUD.
        </p>
      </section>

      <section class="login-grid">
        <div class="login-card">
          <h2>Se connecter</h2>
          <form class="login-form" id="partnerLoginForm" novalidate>
            <div class="form-group">
              <label for="partner-username">Identifiant partenaire</label>
              <input
                type="text"
                id="partner-username"
                name="username"
                placeholder="ex&nbsp;: graine"
                autocomplete="username"
                required
              />
            </div>
            <div class="form-group">
              <label for="partner-password">Mot de passe</label>
              <input
                type="password"
                id="partner-password"
                name="password"
                placeholder="Votre mot de passe"
                autocomplete="current-password"
                required
              />
            </div>
            <button type="submit" class="btn btn-primary">Connexion</button>
            <p class="form-error hidden" id="loginError" role="alert" aria-live="polite">
              Identifiants invalides. Merci de réessayer.
            </p>
          </form>
          <p class="login-footer">
            Besoin d’un accès&nbsp;? Contactez l’équipe via <a href="contact.html">notre formulaire</a>.
          </p>
        </div>
      </section>
    </main>

    <footer class="page-footer">
      <span>&copy; 2025 ECOLUD – Prototype éducatif écologique</span>
      <div class="footer-links">
        <a href="../index.html#missions" data-i18n="footer-missions">Voir les missions</a>
        <a href="#" data-privacy-trigger data-i18n="footer-privacy">Politique de confidentialité</a>
      </div>
    </footer>

    <div id="floating-avatar" class="hidden" aria-hidden="true">
      <img id="avatarCompanion" src="../assets/images/avatars/turtle.png" alt="Mascotte flottante" />
    </div>

    <div class="privacy-modal modal" id="privacy-modal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modal-content" role="document">
        <button type="button" id="close-privacy" aria-label="Fermer">&times;</button>
        <h1>Politique de confidentialité</h1>
        <p><strong>Dernière mise à jour&nbsp;:</strong> 20 octobre 2025</p>
        <h2>1. Responsable du traitement</h2>
        <p>
          <strong>ECOLUD</strong>, prototype éducatif écologique, joignable à
          <a href="mailto:contact@ecolud.org">contact@ecolud.org</a>.
        </p>
        <h2>2. Données collectées</h2>
        <ul>
          <li>Nom, prénom et avatar sélectionné par le joueur.</li>
          <li>Adresse e-mail en cas de contact ou d’inscription.</li>
          <li>Données d’interaction&nbsp;: progression, préférences de langue, messages via le formulaire.</li>
        </ul>
        <h2>3. Finalités du traitement</h2>
        <ul>
          <li>Fournir une expérience ludique et éducative autour de l’écologie.</li>
          <li>Gérer les missions collaboratives, classements et statistiques.</li>
          <li>Répondre aux demandes de contact et assurer le suivi pédagogique.</li>
          <li>Améliorer le contenu et l’ergonomie du site.</li>
        </ul>
        <h2>4. Bases légales</h2>
        <p>
          Les traitements reposent sur le consentement de l'utilisateur, l’exécution d'une mission d’intérêt
          éducatif et le respect d'obligations légales.
        </p>
        <h2>5. Destinataires et transferts</h2>
        <p>
          Les données sont hébergées en Union européenne. Aucune transmission commerciale n'est réalisée.
          Des prestataires techniques agréés peuvent y accéder pour la maintenance du service.
        </p>
        <h2>6. Durée de conservation</h2>
        <p>
          Les données sont conservées uniquement pendant la durée de l’inscription active ou des missions
          éducatives en cours.
        </p>
        <h2>7. Droits de l’utilisateur</h2>
        <p>
          L’utilisateur peut à tout moment demander la suppression ou la rectification de ses données via l’adresse
          <a href="mailto:contact@ecolud.org">contact@ecolud.org</a>.
        </p>
        <h2>8. Sécurité</h2>
        <p>Les données sont protégées par chiffrement SSL et sauvegardes sécurisées.</p>
        <h2>9. Contact</h2>
        <p>
          Pour toute question relative à cette politique&nbsp;:
          <a href="mailto:contact@ecolud.org">contact@ecolud.org</a>
        </p>
      </div>
    </div>

    <script src="../assets/js/auth.js" defer></script>
    <script src="../assets/js/app.js" defer></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        if (window.auth && typeof window.auth.isAuthenticated === 'function' && window.auth.isAuthenticated()) {
          window.location.href = 'prototypes.html';
          return;
        }

        const form = document.getElementById('partnerLoginForm');
        const usernameInput = document.getElementById('partner-username');
        const passwordInput = document.getElementById('partner-password');
        const errorMessage = document.getElementById('loginError');

        const showError = (message) => {
          if (!errorMessage) return;
          errorMessage.textContent = message;
          errorMessage.classList.remove('hidden');
        };

        form.addEventListener('submit', (event) => {
          event.preventDefault();
          if (errorMessage) {
            errorMessage.classList.add('hidden');
          }
          const username = usernameInput.value.trim();
          const password = passwordInput.value;
          if (!username || !password) {
            showError('Merci de renseigner vos identifiants.');
            return;
          }
          const account =
            window.auth && typeof window.auth.login === 'function'
              ? window.auth.login(username, password)
              : null;
          if (account) {
            window.location.href = 'prototypes.html';
            return;
          }
          showError('Identifiants invalides. Merci de réessayer.');
        });
      });
    </script>
  </body>
</html>
